
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>variables &#8212; python decomposition library 0.1 documentation</title>
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">python decomposition library 0.1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for variables</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Thu Feb 15 10:47:32 2018</span>

<span class="sd">@author: Diego Britez</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="sd">&quot;&quot;&quot;In this module many variables are going to be calculated such as Gammax, Gammay, Betax, Betay&quot;&quot;&quot;</span>

<div class="viewcode-block" id="alpha"><a class="viewcode-back" href="../FIX-POINT_VARIABLES.html#variables.alpha">[docs]</a><span class="k">def</span> <span class="nf">alpha</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">M</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;This function calculates the value of the </span>
<span class="sd">    :math:`\\alpha`</span>
<span class="sd">    variable in the fix point algorithm:  \n</span>
<span class="sd">    </span>
<span class="sd">    :math:`\\alpha^{s}=\int_{\Omega/\Omega_{s}}\prod_{i=1}^{s-1}(X_{i}^{k+1})^</span>
<span class="sd">    {2}\prod_{i=s+1}^{d}(X_{i}^{k})^{2}`, which could be expressed also as: \n</span>
<span class="sd">    :math:`\\alpha^{s}=\prod_{i=1}^{s-1}\int_{\Omega_{i}}(X_{i}^{k+1})^</span>
<span class="sd">    {2}dx_{i}\prod_{i=s+1}^{d}\int_{\Omega_{i}}(X_{i}^{k})^{2}	dx_{i}`</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">R1</span><span class="o">=</span><span class="n">R</span><span class="p">[:]</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">R1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">R1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">R1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">R1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
    <span class="n">M1</span><span class="o">=</span><span class="n">M</span><span class="p">[:]</span>
    <span class="n">M1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">M1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">M1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
   
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            
            <span class="n">R1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R1</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">R1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">aux</span><span class="o">=</span><span class="n">R1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="nd">@M1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="o">*</span><span class="n">aux</span></div>
    <span class="k">return</span> <span class="n">alpha</span>
    

<div class="viewcode-block" id="gamma"><a class="viewcode-back" href="../FIX-POINT_VARIABLES.html#variables.gamma">[docs]</a><span class="k">def</span> <span class="nf">gamma</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">dim</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function will return the value of the </span>
<span class="sd">    :math:`gamma</span>
<span class="sd">    variable for each iteration in the fix poitn algorithm.</span>
<span class="sd">    :math:`\gamma^{s}(x_{s})= \int_{\Omega/\Omega_{s}}(\prod_{i=1}^{s-1}</span>
<span class="sd">    X_{i}^{k+1}\prod_{i=s+1}^{D}X_{i}^{k}).F`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">F2</span><span class="o">=</span><span class="n">F</span>
    <span class="n">F2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">F2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>        
    <span class="n">R1</span><span class="o">=</span><span class="n">R</span><span class="p">[:]</span>
    <span class="n">R1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">R1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">R1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">R1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">M1</span><span class="o">=</span><span class="n">M</span><span class="p">[:]</span>
    <span class="n">M1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">M1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">M1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        
        <span class="n">F2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">F2</span><span class="p">,</span><span class="n">R1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">F2</span><span class="o">=</span><span class="n">F2</span><span class="nd">@M1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></div>
    <span class="k">return</span> <span class="n">F2</span>



<div class="viewcode-block" id="betha"><a class="viewcode-back" href="../FIX-POINT_VARIABLES.html#variables.betha">[docs]</a><span class="k">def</span> <span class="nf">betha</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">dim</span><span class="p">):</span>
    
     <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     This function calculates the value of the </span>
<span class="sd">     :math:`\\beta`</span>
<span class="sd">     variable in the fix point algorithm:  \n</span>
<span class="sd">     </span>
<span class="sd">     :math:`\\beta^{s}(j)=\int_{\Omega/\Omega_{s}}\prod_{i=1}^{s-1}(X_{i}^{k+1}</span>
<span class="sd">     X_{i}^{j})\prod_{i=s+1}^{d}(X_{i}^{k}X_{i}^{j})`, which  could be expressed</span>
<span class="sd">     as, \n</span>
<span class="sd">     :math:`\\beta^{s}(j)=\prod_{i=1}^{s-1}\int_{\Omega}(X_{i}^{k+1}X_{i}^{j})</span>
<span class="sd">     \prod_{i=s+1}^{d}\int_{\Omega_{s}}\prod_{i=s+1}^{d}(X_{i}^{k}</span>
<span class="sd">     X_{i}^{j})dx_{i}`</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="n">M1</span><span class="o">=</span><span class="n">M</span><span class="p">[:]</span>
     <span class="n">M1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">M1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">M1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">M1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  
     <span class="n">U1</span><span class="o">=</span><span class="n">U</span><span class="p">[:]</span>
     <span class="n">U1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">U1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">U1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">U1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
     <span class="n">R1</span><span class="o">=</span><span class="n">R</span><span class="p">[:]</span>    
     <span class="n">R1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">R1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">R1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">R1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
     
     
     <span class="n">Betha</span><span class="o">=</span><span class="mi">1</span>
     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dim</span><span class="p">):</span>
         
         <span class="n">aux2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">U1</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">R1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
         <span class="n">aux2</span><span class="o">=</span><span class="n">aux2</span><span class="nd">@M1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
         <span class="n">Betha</span><span class="o">=</span><span class="n">Betha</span><span class="o">*</span><span class="n">aux2</span>
         
             </div>
     <span class="k">return</span> <span class="n">Betha</span>    
     
<span class="sd">&quot;&quot;&quot; </span>
<span class="sd">if __name__==&quot;__main__&quot;:</span>
<span class="sd">    F=np.arange(120)</span>
<span class="sd">    F=F.reshape(5,6,4)</span>
<span class="sd">    lower_limit=np.array([0,0,0])</span>
<span class="sd">    upper_limit =np.array([1,1,1])</span>
<span class="sd">    tshape=np.array([5,6,4])</span>
<span class="sd">    dim=3</span>

<span class="sd">    Vector = CartesianGrid.CartesianGrid(dim, tshape, lower_limit, upper_limit)</span>

<span class="sd">    X = Vector.SpaceCreator()    </span>
<span class="sd">    New_Solution=IterationSolution(tshape,dim)</span>
<span class="sd">    New_Solution._current_solution_initialization()</span>
<span class="sd">    R=New_Solution.R</span>
<span class="sd">    i=1</span>

<span class="sd">    F2=F</span>
<span class="sd">    R2=R</span>
<span class="sd">    R2[0],R2[i]=R2[i],R2[0]</span>
<span class="sd">    X2=X</span>
<span class="sd">    X2[0],X2[i]=X2[i],X2[0]</span>
<span class="sd">    F2=np.swapaxes(F2,0,i)</span>


<span class="sd">    for j in range(dim-1,1,-1):</span>
<span class="sd">        F2=np.multiply(F2,R2[j])</span>
<span class="sd">        F2=integration_1dtrap(F2,X2[j]) </span>
<span class="sd">&quot;&quot;&quot;</span>

</pre></div>

          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Decomposition_Functions.html">High Order Decomposition Methods Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classes.html">Classes  Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmark_multivariable.html">BENCHMARK_MULTIVARIABLE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../high_order_subfunctions1.html">High Order Decomposition sub Functions</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Diego Britez.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>